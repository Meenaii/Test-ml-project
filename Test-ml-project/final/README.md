# üìå –û–ø–∏—Å–∞–Ω–∏–µ
–í –¥–∞–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ—à–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å, —Å–æ–≤–µ—Ä—à–∏—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ü–µ–ª–µ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ —Å–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å–∞ –ø–æ –∞—Ä–µ–Ω–¥–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π.
[–î–∞–Ω–Ω—ã–µ](https://drive.google.com/drive/folders/1rA4o6KHH-M2KMvBLHp5DZ5gioF2q7hZw) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –ª–æ–≥–∏ –∏–∑ Google Analytics: ga_sessions –∏ ga_hits. –û–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö ‚Äî ~4.3 –ì–ë.

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
.
‚îú‚îÄ‚îÄ data/                    # –°—ã—Ä—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (.csv/.pickle) 
‚îÇ                            # –í–ê–ñ–ù–û: –¥–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–µ—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏–∑-–∑–∞ –æ–≥—Ä–æ–º–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤, —Å–æ–∑–¥–∞—Ç—å –µ—ë –Ω—É–∂–Ω–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ
‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îú‚îÄ‚îÄ metada.json          # –î–∞–Ω–Ω—ã–µ, —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –∏–∑ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ—Å—è –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ classifier_pipe.pkl  # C–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ preprocess.py        # –§—É–Ω–∫—Ü–∏–∏ –ø–æ –æ—á–∏—Å—Ç–∫–µ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—é –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ preprocess_predict.py # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ train.py             # –û–±—É—á–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ predict_data/            # –î–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π, –∞ —Ç–∞–∫ –∂–µ —Ñ–∞–π–ª —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
‚îú‚îÄ‚îÄ predict.py               # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º
‚îî‚îÄ‚îÄ README.md                # –≠—Ç–æ—Ç —Ñ–∞–π–ª

```
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

* –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü sessions –∏ hits –ø–æ session_id.

* –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
    * –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ: –ø–æ—Å–µ—â–∞–ª–∏ –ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–≤—Ç–æ, —á–∏—Å–ª–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö –∞–≤—Ç–æ, –≥–ª—É–±–∏–Ω–∞ —Å–µ—Å—Å–∏–∏, –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–µ –∞–≤—Ç–æ;
    * –≤—Ä–µ–º–µ–Ω–Ω—ã–µ: —á–∞—Å –≤–∏–∑–∏—Ç–∞, –º–µ—Å—è—Ü, –¥–µ–Ω—å, –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏;
    * —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –û–°, —Ä–µ–∫–ª–∞–º–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏.
* –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, visit_number > 100).
* –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤.
* –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —á–µ—Ä–µ–∑ OneHot –∏ Robust —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω–æ

# üß™ –û–±—É—á–µ–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–≤–µ –º–æ–¥–µ–ª–∏: LogisticRegression –∏ CatBoostClassifier.
–î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ —É—á—Ç—ë–Ω —Å –ø–æ–º–æ—â—å—é class_weight='balanced'.
–û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–∞—Å—å –ø–æ –º–µ—Ç—Ä–∏–∫–µ ROC-AUC –ø–æ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏.

üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ú–æ–¥–µ–ª—å             | ROC-AUC |
|--------------------|---------|
| LogisticRegression | 81.2%   |
| CatBoostClassifier | 85.6%   |

# üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

```bash
predict.py
```
predict.py –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–æ–¥–µ–ª—å –∫ –Ω–æ–≤—ã–º ga_sessions.csv –∏ ga_hits.csv –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ predict_data/ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ predictions.csv,
–µ—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –ø—Ä–∏ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ —Ç–∞–∫–∂–µ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª.

```python
import pandas as pd
import dill
from model.preprocess_predict import prepare_data

with open('model/classifier_pipe.pkl', 'rb') as file:
   model = dill.load(file)
#–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
def main():
    df_hits = pd.read_csv('predict_data/ga_hits_session1.csv').drop(['event_value',
                                                    'hit_referer',
                                                    'hit_time',
                                                    'event_label'], axis=1)

    df_sessions =  pd.read_csv('predict_data/ga_sessinons_session1.csv', low_memory=False).drop(['device_model',
                                                                          'utm_keyword'], axis = 1)
```
# üìé –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
–í—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –±—ã–ª–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ –æ–±—É—á–∞—é—â–µ–º –¥–∞—Ç–∞—Å–µ—Ç–µ.
–ü—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ —Å–ø–∏—Å–æ–∫ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤, –≥—Ä–∞–Ω–∏—Ü—ã –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ –∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ (—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ metadata.json).
